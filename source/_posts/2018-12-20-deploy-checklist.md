---
layout: post
title: 升级发版检查表
category: 系统运维
tags:
- Web
- 项目实施
---
系统升级和发版是一个动静很大的操作，必须充分做好实施计划和应急预案。本文是我们项目（项目制）日常升级的检查表，供大家参考。

<!-- more -->

* 完成项目内准备工作
    * 完成所有功能测试
    * 完成代码审查，严重缺陷全部关闭
    * 制定对外的发版说明，准备推送内容，更新“更新历史”内容
    * 封版、打基线
    * 应用打包
    * 检查打包内容，确认已按生产环境配置，而且不包含.svn、.git、.DS_Store这样的敏感文件
    * 完成部门内部申请流程
* 完成与甲方的沟通工作（需提前一周实施）
    * 决定向甲方报告的内容，提交相关申请材料，跟踪甲方审核进度
    * 审核通过后申请堡垒机操作权限
* 提前在系统进行升级公告，使用户做好准备（我们设计了相关功能，只要在数据库插入一条记录就能展示公告）
* 实施升级
    * 检查内存、硬盘使用情况，如果硬盘剩余空间不足则清理或压缩旧备份与旧日志
    * 备份原程序
    * 暂停Web应用防火墙（WAF）防护
    * 检查应用运行情况，如有卡死等问题先重启，以免更新操作失败
    * 将程序替换为新版本并进行Web服务器的更新
    * 执行升级初始化SQL
    * 如有数据库表结构调整，并且涉及OGG传输（Oracle），则需要同时处理OGG的源端和汇聚端，并确保OGG状态正常
* 升级后验证
    * 观察应用是否正常启动
    * 进行功能验证，发现问题及时处理。若在堡垒机权限结束前无法修复，那么则进行回滚（包括程序包和SQL），放弃升级
    * 全部操作完成后，恢复WAF防护
* 结束
    * 通知甲方升级顺利完成
    * 向用户推送新版本的发版说明
    * 向客服和运维人员通知升级内容
